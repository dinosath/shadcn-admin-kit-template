{% import "macros.jinja" as macros -%}
{
  "mappings": [
{% if authentication == 'jwt' or authentication == 'oidc' -%}
    {
      "name": "Login",
      "request": {
        "method": "POST",
        "urlPath": "/api/auth/login"
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "access_token": "mock-jwt-token-for-testing",
          "token_type": "Bearer",
          "expires_in": 3600,
          "user": {
            "id": 1,
            "username": "admin",
            "email": "admin@example.com",
            "roles": ["admin"]
          }
        }
      }
    },
    {
      "name": "Get current user",
      "request": {
        "method": "GET",
        "urlPath": "/api/auth/me"
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "id": 1,
          "username": "admin",
          "email": "admin@example.com",
          "roles": ["admin"]
        }
      }
    },
    {
      "name": "Logout",
      "request": {
        "method": "POST",
        "urlPath": "/api/auth/logout"
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "message": "Logged out successfully"
        }
      }
    },
    {
      "name": "Register",
      "request": {
        "method": "POST",
        "urlPath": "/api/auth/register"
      },
      "response": {
        "status": 201,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "id": 2,
          "username": "newuser",
          "email": "newuser@example.com",
          "roles": ["user"]
        }
      }
    },
{% endif -%}
{% for entity_name, entity in entities | items | selectattr("1.attributes") -%}
{% set entity_plural = entity_name | plural | snake_case -%}
{% set entity_singular = entity_name | snake_case -%}
    {
      "name": "Get {{ entity_plural }} list",
      "request": {
        "method": "GET",
        "urlPathPattern": "/api/{{ entity_plural }}"
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json",
          "Content-Range": "{{ entity_plural }} 0-2/3",
          "Access-Control-Expose-Headers": "Content-Range"
        },
        "jsonBody": [
{% for i in range(1, 4) %}
          {
            "id": {{ i }},
            "created_at": "2024-01-0{{ i }}T00:00:00Z",
            "last_updated": "2024-01-0{{ i }}T00:00:00Z"{% for name, property in entity.attributes | items %},
{% if property.type == 'relation' -%}
{% if property.relation == 'manyToOne' or property.relation == 'oneToOne' -%}
            "{{ name | snake_case }}": { "id": {{ i }} }
{%- elif property.relation == 'manyToMany' or property.relation == 'oneToMany' -%}
            "{{ name | snake_case }}": [{{ i }}]
{%- endif -%}
{%- elif property.type == 'string' -%}
{% if property.format == 'email' -%}
            "{{ name | snake_case }}": "{{ name | snake_case }}{{ i }}@example.com"
{%- elif property.format == 'uri' or property.format == 'url' -%}
            "{{ name | snake_case }}": "https://example.com/{{ name | snake_case }}/{{ i }}"
{%- else -%}
            "{{ name | snake_case }}": "{{ name | title | replace("_", " ") }} {{ i }}"
{%- endif -%}
{%- elif property.type == 'text' -%}
            "{{ name | snake_case }}": "Sample {{ name | title | replace("_", " ") }} content for item {{ i }}."
{%- elif property.type == 'integer' or property.type == 'number' or property.type == 'biginteger' -%}
            "{{ name | snake_case }}": {{ property.default | default(i * 10) }}
{%- elif property.type == 'boolean' -%}
            "{{ name | snake_case }}": {{ 'true' if i % 2 == 1 else 'false' }}
{%- elif property.type == 'datetime' or property.type == 'date' -%}
            "{{ name | snake_case }}": "2024-01-0{{ i }}T12:00:00Z"
{%- elif property.type == 'enumeration' or property.enum -%}
            "{{ name | snake_case }}": "{{ property.enum[0] if property.enum else 'default' }}"
{%- else -%}
            "{{ name | snake_case }}": null
{%- endif -%}
{% endfor %}
          }{% if not loop.last %},{% endif %}
{% endfor %}
        ]
      }
    },
    {
      "name": "Get single {{ entity_singular }}",
      "request": {
        "method": "GET",
        "urlPathPattern": "/api/{{ entity_plural }}/[0-9]+"
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "id": 1,
          "created_at": "2024-01-01T00:00:00Z",
          "last_updated": "2024-01-01T00:00:00Z"{% for name, property in entity.attributes | items %},
{% if property.type == 'relation' -%}
{% if property.relation == 'manyToOne' or property.relation == 'oneToOne' -%}
          "{{ name | snake_case }}": { "id": 1 }
{%- elif property.relation == 'manyToMany' or property.relation == 'oneToMany' -%}
          "{{ name | snake_case }}": [1]
{%- endif -%}
{%- elif property.type == 'string' -%}
{% if property.format == 'email' -%}
          "{{ name | snake_case }}": "{{ name | snake_case }}@example.com"
{%- elif property.format == 'uri' or property.format == 'url' -%}
          "{{ name | snake_case }}": "https://example.com/{{ name | snake_case }}/1"
{%- else -%}
          "{{ name | snake_case }}": "{{ name | title | replace("_", " ") }} 1"
{%- endif -%}
{%- elif property.type == 'text' -%}
          "{{ name | snake_case }}": "Sample {{ name | title | replace("_", " ") }} content."
{%- elif property.type == 'integer' or property.type == 'number' or property.type == 'biginteger' -%}
          "{{ name | snake_case }}": {{ property.default | default(10) }}
{%- elif property.type == 'boolean' -%}
          "{{ name | snake_case }}": true
{%- elif property.type == 'datetime' or property.type == 'date' -%}
          "{{ name | snake_case }}": "2024-01-01T12:00:00Z"
{%- elif property.type == 'enumeration' or property.enum -%}
          "{{ name | snake_case }}": "{{ property.enum[0] if property.enum else 'default' }}"
{%- else -%}
          "{{ name | snake_case }}": null
{%- endif -%}
{% endfor %}
        }
      }
    },
    {
      "name": "Create {{ entity_singular }}",
      "request": {
        "method": "POST",
        "urlPath": "/api/{{ entity_plural }}"
      },
      "response": {
        "status": 201,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "id": 4,
          "created_at": "2024-01-04T00:00:00Z",
          "last_updated": "2024-01-04T00:00:00Z"{% for name, property in entity.attributes | items %},
{% if property.type == 'relation' -%}
{% if property.relation == 'manyToOne' or property.relation == 'oneToOne' -%}
          "{{ name | snake_case }}": { "id": 1 }
{%- elif property.relation == 'manyToMany' or property.relation == 'oneToMany' -%}
          "{{ name | snake_case }}": []
{%- endif -%}
{%- elif property.type == 'string' -%}
{% if property.format == 'email' -%}
          "{{ name | snake_case }}": "new_{{ name | snake_case }}@example.com"
{%- elif property.format == 'uri' or property.format == 'url' -%}
          "{{ name | snake_case }}": "https://example.com/{{ name | snake_case }}/new"
{%- else -%}
          "{{ name | snake_case }}": "New {{ name | title | replace("_", " ") }}"
{%- endif -%}
{%- elif property.type == 'text' -%}
          "{{ name | snake_case }}": "New {{ name | title | replace("_", " ") }} content."
{%- elif property.type == 'integer' or property.type == 'number' or property.type == 'biginteger' -%}
          "{{ name | snake_case }}": {{ property.default | default(0) }}
{%- elif property.type == 'boolean' -%}
          "{{ name | snake_case }}": {{ 'true' if property.default else 'false' }}
{%- elif property.type == 'datetime' or property.type == 'date' -%}
          "{{ name | snake_case }}": "2024-01-04T12:00:00Z"
{%- elif property.type == 'enumeration' or property.enum -%}
          "{{ name | snake_case }}": "{{ property.enum[0] if property.enum else 'default' }}"
{%- else -%}
          "{{ name | snake_case }}": null
{%- endif -%}
{% endfor %}
        }
      }
    },
    {
      "name": "Update {{ entity_singular }}",
      "request": {
        "method": "PUT",
        "urlPathPattern": "/api/{{ entity_plural }}/[0-9]+"
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "id": 1,
          "created_at": "2024-01-01T00:00:00Z",
          "last_updated": "2024-01-04T12:00:00Z"{% for name, property in entity.attributes | items %},
{% if property.type == 'relation' -%}
{% if property.relation == 'manyToOne' or property.relation == 'oneToOne' -%}
          "{{ name | snake_case }}": { "id": 1 }
{%- elif property.relation == 'manyToMany' or property.relation == 'oneToMany' -%}
          "{{ name | snake_case }}": [1]
{%- endif -%}
{%- elif property.type == 'string' -%}
{% if property.format == 'email' -%}
          "{{ name | snake_case }}": "updated_{{ name | snake_case }}@example.com"
{%- elif property.format == 'uri' or property.format == 'url' -%}
          "{{ name | snake_case }}": "https://example.com/{{ name | snake_case }}/updated"
{%- else -%}
          "{{ name | snake_case }}": "Updated {{ name | title | replace("_", " ") }}"
{%- endif -%}
{%- elif property.type == 'text' -%}
          "{{ name | snake_case }}": "Updated {{ name | title | replace("_", " ") }} content."
{%- elif property.type == 'integer' or property.type == 'number' or property.type == 'biginteger' -%}
          "{{ name | snake_case }}": {{ property.default | default(100) }}
{%- elif property.type == 'boolean' -%}
          "{{ name | snake_case }}": true
{%- elif property.type == 'datetime' or property.type == 'date' -%}
          "{{ name | snake_case }}": "2024-01-04T12:00:00Z"
{%- elif property.type == 'enumeration' or property.enum -%}
          "{{ name | snake_case }}": "{{ property.enum[0] if property.enum else 'default' }}"
{%- else -%}
          "{{ name | snake_case }}": null
{%- endif -%}
{% endfor %}
        }
      }
    },
    {
      "name": "Delete {{ entity_singular }}",
      "request": {
        "method": "DELETE",
        "urlPathPattern": "/api/{{ entity_plural }}/[0-9]+"
      },
      "response": {
        "status": 200,
        "headers": {
          "Content-Type": "application/json"
        },
        "jsonBody": {
          "id": 1
        }
      }
    },
{% endfor %}
    {
      "name": "CORS preflight",
      "request": {
        "method": "OPTIONS",
        "urlPattern": "/api/.*"
      },
      "response": {
        "status": 204,
        "headers": {
          "Access-Control-Allow-Origin": "*",
          "Access-Control-Allow-Methods": "GET, POST, PUT, DELETE, OPTIONS",
          "Access-Control-Allow-Headers": "Content-Type, Authorization, Content-Range, X-Total-Count",
          "Access-Control-Expose-Headers": "Content-Range, X-Total-Count",
          "Access-Control-Max-Age": "86400"
        }
      }
    }
  ]
}
